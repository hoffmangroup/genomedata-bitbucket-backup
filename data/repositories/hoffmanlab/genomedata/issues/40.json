{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/hoffmanlab/genomedata.json"}, "html": {"href": "#!/hoffmanlab/genomedata"}, "avatar": {"href": "data/bytebucket.org/ravatar/{78038659-1199-46ff-9d0a-675c62f89d60}ts=python"}}, "type": "repository", "name": "genomedata", "full_name": "hoffmanlab/genomedata", "uuid": "{78038659-1199-46ff-9d0a-675c62f89d60}"}, "links": {"attachments": {"href": "data/repositories/hoffmanlab/genomedata/issues/40/attachments_page=1.json"}, "self": {"href": "data/repositories/hoffmanlab/genomedata/issues/40.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/genomedata/issues/40/watch"}, "comments": {"href": "data/repositories/hoffmanlab/genomedata/issues/40/comments_page=1.json"}, "html": {"href": "#!/hoffmanlab/genomedata/issues/40/genomedata-erase-data-doesnt-work"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/genomedata/issues/40/vote"}}, "reporter": {"display_name": "Rachel Chan", "uuid": "{20430f8d-4e6b-48cc-a8d8-c64868bf7e79}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D"}, "html": {"href": "https://bitbucket.org/%7B20430f8d-4e6b-48cc-a8d8-c64868bf7e79%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/4397abec9f84e35f1f235b350984833dd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRC-1.png"}}, "nickname": "rcwchan", "type": "user", "account_id": "557058:e439e22e-8cfc-4cf1-b090-030d33a0730e"}, "title": "genomedata-erase-data doesn't work", "component": null, "votes": 0, "watches": 1, "content": {"raw": "Specifically, the arg parser (if called from commandline) is searching for attributes that don't exist:\r\n \r\nFrom `_erase_data.py`:\r\n```\r\n#!python\r\n\r\n38 def parse_options(args):\r\n 39 \r\n 40     description = (\"Erase the specified tracks from the Genomedata archive\"\r\n 41                    \" in such a way that the track data can be replaced\"\r\n 42                    \" (via genomedata-load-data).\")\r\n 43 \r\n 44     parser = ArgumentParser(description=description,\r\n 45                             prog='genomedata-erase-data',\r\n 46                             version=__version__)\r\n 47 \r\n 48     parser.add_argument('gdarchive', help='genomedata archive')\r\n 49 \r\n 50     parser.add_argument(\"--trackname\", required=True, nargs='+',\r\n 51                         help=\"tracknames to erase\")\r\n 52 \r\n 53     parser.add_argument(\"--verbose\", default=False, action=\"store_true\",\r\n 54                         help=\"Print status updates and diagnostic messages\")\r\n 55 \r\n 56     args = parser.parse_args(args)\r\n 57 \r\n 58     return args\r\n 59 \r\n 60 def main(argv=sys.argv[1:]):\r\n 61     args = parse_options(argv)\r\n 62     gdarchive = args.archive\r\n 63 \r\n 64     for trackname in args.tracknames:\r\n 65         erase_data(gdarchive, trackname, verbose=args.verbose)\r\n 66 \r\n 67 if __name__ == \"__main__\":\r\n 68     sys.exit(main())                                   \r\n```\r\n\r\nIn particular, `args.archive` should be `args.gdarchive`, `args.tracknames` doesn't exist, etc. Edit: Possibly a test should be added for it in the genomedata test suite?", "markup": "markdown", "html": "<p>Specifically, the arg parser (if called from commandline) is searching for attributes that don't exist:</p>\n<p>From <code>_erase_data.py</code>:</p>\n<div class=\"codehilite language-python\"><pre><span></span><span class=\"mi\">38</span> <span class=\"k\">def</span> <span class=\"nf\">parse_options</span><span class=\"p\">(</span><span class=\"n\">args</span><span class=\"p\">):</span>\n <span class=\"mi\">39</span> \n <span class=\"mi\">40</span>     <span class=\"n\">description</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"s2\">&quot;Erase the specified tracks from the Genomedata archive&quot;</span>\n <span class=\"mi\">41</span>                    <span class=\"s2\">&quot; in such a way that the track data can be replaced&quot;</span>\n <span class=\"mi\">42</span>                    <span class=\"s2\">&quot; (via genomedata-load-data).&quot;</span><span class=\"p\">)</span>\n <span class=\"mi\">43</span> \n <span class=\"mi\">44</span>     <span class=\"n\">parser</span> <span class=\"o\">=</span> <span class=\"n\">ArgumentParser</span><span class=\"p\">(</span><span class=\"n\">description</span><span class=\"o\">=</span><span class=\"n\">description</span><span class=\"p\">,</span>\n <span class=\"mi\">45</span>                             <span class=\"n\">prog</span><span class=\"o\">=</span><span class=\"s1\">&#39;genomedata-erase-data&#39;</span><span class=\"p\">,</span>\n <span class=\"mi\">46</span>                             <span class=\"n\">version</span><span class=\"o\">=</span><span class=\"n\">__version__</span><span class=\"p\">)</span>\n <span class=\"mi\">47</span> \n <span class=\"mi\">48</span>     <span class=\"n\">parser</span><span class=\"o\">.</span><span class=\"n\">add_argument</span><span class=\"p\">(</span><span class=\"s1\">&#39;gdarchive&#39;</span><span class=\"p\">,</span> <span class=\"n\">help</span><span class=\"o\">=</span><span class=\"s1\">&#39;genomedata archive&#39;</span><span class=\"p\">)</span>\n <span class=\"mi\">49</span> \n <span class=\"mi\">50</span>     <span class=\"n\">parser</span><span class=\"o\">.</span><span class=\"n\">add_argument</span><span class=\"p\">(</span><span class=\"s2\">&quot;--trackname&quot;</span><span class=\"p\">,</span> <span class=\"n\">required</span><span class=\"o\">=</span><span class=\"bp\">True</span><span class=\"p\">,</span> <span class=\"n\">nargs</span><span class=\"o\">=</span><span class=\"s1\">&#39;+&#39;</span><span class=\"p\">,</span>\n <span class=\"mi\">51</span>                         <span class=\"n\">help</span><span class=\"o\">=</span><span class=\"s2\">&quot;tracknames to erase&quot;</span><span class=\"p\">)</span>\n <span class=\"mi\">52</span> \n <span class=\"mi\">53</span>     <span class=\"n\">parser</span><span class=\"o\">.</span><span class=\"n\">add_argument</span><span class=\"p\">(</span><span class=\"s2\">&quot;--verbose&quot;</span><span class=\"p\">,</span> <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"bp\">False</span><span class=\"p\">,</span> <span class=\"n\">action</span><span class=\"o\">=</span><span class=\"s2\">&quot;store_true&quot;</span><span class=\"p\">,</span>\n <span class=\"mi\">54</span>                         <span class=\"n\">help</span><span class=\"o\">=</span><span class=\"s2\">&quot;Print status updates and diagnostic messages&quot;</span><span class=\"p\">)</span>\n <span class=\"mi\">55</span> \n <span class=\"mi\">56</span>     <span class=\"n\">args</span> <span class=\"o\">=</span> <span class=\"n\">parser</span><span class=\"o\">.</span><span class=\"n\">parse_args</span><span class=\"p\">(</span><span class=\"n\">args</span><span class=\"p\">)</span>\n <span class=\"mi\">57</span> \n <span class=\"mi\">58</span>     <span class=\"k\">return</span> <span class=\"n\">args</span>\n <span class=\"mi\">59</span> \n <span class=\"mi\">60</span> <span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">(</span><span class=\"n\">argv</span><span class=\"o\">=</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">:]):</span>\n <span class=\"mi\">61</span>     <span class=\"n\">args</span> <span class=\"o\">=</span> <span class=\"n\">parse_options</span><span class=\"p\">(</span><span class=\"n\">argv</span><span class=\"p\">)</span>\n <span class=\"mi\">62</span>     <span class=\"n\">gdarchive</span> <span class=\"o\">=</span> <span class=\"n\">args</span><span class=\"o\">.</span><span class=\"n\">archive</span>\n <span class=\"mi\">63</span> \n <span class=\"mi\">64</span>     <span class=\"k\">for</span> <span class=\"n\">trackname</span> <span class=\"ow\">in</span> <span class=\"n\">args</span><span class=\"o\">.</span><span class=\"n\">tracknames</span><span class=\"p\">:</span>\n <span class=\"mi\">65</span>         <span class=\"n\">erase_data</span><span class=\"p\">(</span><span class=\"n\">gdarchive</span><span class=\"p\">,</span> <span class=\"n\">trackname</span><span class=\"p\">,</span> <span class=\"n\">verbose</span><span class=\"o\">=</span><span class=\"n\">args</span><span class=\"o\">.</span><span class=\"n\">verbose</span><span class=\"p\">)</span>\n <span class=\"mi\">66</span> \n <span class=\"mi\">67</span> <span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;__main__&quot;</span><span class=\"p\">:</span>\n <span class=\"mi\">68</span>     <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">exit</span><span class=\"p\">(</span><span class=\"n\">main</span><span class=\"p\">())</span>                                   \n</pre></div>\n\n\n<p>In particular, <code>args.archive</code> should be <code>args.gdarchive</code>, <code>args.tracknames</code> doesn't exist, etc. Edit: Possibly a test should be added for it in the genomedata test suite?</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": null, "edited_on": null, "created_on": "2017-07-14T14:46:31.378030+00:00", "milestone": null, "updated_on": "2017-07-14T17:59:21.514745+00:00", "type": "issue", "id": 40}