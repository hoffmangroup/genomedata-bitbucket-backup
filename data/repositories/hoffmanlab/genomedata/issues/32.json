{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/hoffmanlab/genomedata.json"}, "html": {"href": "#!/hoffmanlab/genomedata"}, "avatar": {"href": "data/bytebucket.org/ravatar/{78038659-1199-46ff-9d0a-675c62f89d60}ts=python"}}, "type": "repository", "name": "genomedata", "full_name": "hoffmanlab/genomedata", "uuid": "{78038659-1199-46ff-9d0a-675c62f89d60}"}, "links": {"attachments": {"href": "data/repositories/hoffmanlab/genomedata/issues/32/attachments_page=1.json"}, "self": {"href": "data/repositories/hoffmanlab/genomedata/issues/32.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/genomedata/issues/32/watch"}, "comments": {"href": "data/repositories/hoffmanlab/genomedata/issues/32/comments_page=1.json"}, "html": {"href": "#!/hoffmanlab/genomedata/issues/32/h5repack-segfaults-in-rare-cases-of"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/hoffmanlab/genomedata/issues/32/vote"}}, "reporter": {"display_name": "Coby Viner", "uuid": "{5c0277b2-d18f-432a-9ff0-3377d3063bd6}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5c0277b2-d18f-432a-9ff0-3377d3063bd6%7D"}, "html": {"href": "https://bitbucket.org/%7B5c0277b2-d18f-432a-9ff0-3377d3063bd6%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/30ee4699432a3591c043fbe3d4bff771d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCV-5.png"}}, "nickname": "cviner2", "type": "user", "account_id": "557058:278c659b-177a-486c-bf20-6982986d7e43"}, "title": "h5repack segfaults (in rare cases of unknown etiology)", "component": null, "votes": 0, "watches": 2, "content": {"raw": "One Genomedata run, out of multiple similar parallel runs, segfaulted, producing a core dump. This has also happened twice on a previous occasion, but I mis-attributed them to system-specific aberrations.\r\n\r\nInspection of the `core` file produced (and enclosed, gzipped), via `file` yields:\r\n\r\n\r\n```\r\n#!text\r\n\r\ncore.19535: ELF 64-bit LSB core file x86-64, version 1 (SYSV), SVR4-style, from 'h5repack -f GZIP=1 /mnt/work1/users/hoffmangroup/cviner/temp/genomedata.MfLZzl/', real uid: 1060, effective uid: 1060, real gid: 1037, effective gid: 1037, execfn: '/usr/bin/h5repack', platform: 'x86_64'\r\n```\r\n\r\n`/usr/bin/h5repack --version` yielded: `h5repack: (Version 1.8.7)`.\r\n\r\nExecution of a `gdb` backtrace on `h5repack` with this core file, yields the following stack trace:\r\n\r\n\r\n```\r\n#!text\r\n\r\nCore was generated by `h5repack -f GZIP=1 /mnt/work1/users/hoffmangroup/cviner/temp/genomedata.MfLZzl/'.\r\nProgram terminated with signal 11, Segmentation fault.\r\n#0  H5O_dec_rc (oh=0x0) at H5O.c:3416\r\n3416\tH5O.c: No such file or directory.\r\n\tin H5O.c\r\nMissing separate debuginfos, use: debuginfo-install hdf5-1.8.7-1.el6.rf.x86_64\r\n(gdb) bt\r\n#0  H5O_dec_rc (oh=0x0) at H5O.c:3416\r\n#1  0x0000003cff127ff7 in H5O_chunk_proxy_dest (f=0x267a2a0, dxpl_id=167772168, addr=<value optimized out>, _udata=<value optimized out>) at H5Ocache.c:1443\r\n#2  H5O_cache_chk_load (f=0x267a2a0, dxpl_id=167772168, addr=<value optimized out>, _udata=<value optimized out>) at H5Ocache.c:758\r\n#3  0x0000003cff067ea3 in H5C_load_entry (f=0x267a2a0, primary_dxpl_id=167772168, secondary_dxpl_id=<value optimized out>, type=0x3cff491f60, addr=<value optimized out>, udata=<value optimized out>, flags=512) at H5C.c:7955\r\n#4  H5C_protect (f=0x267a2a0, primary_dxpl_id=167772168, secondary_dxpl_id=<value optimized out>, type=0x3cff491f60, addr=<value optimized out>, udata=<value optimized out>, flags=512) at H5C.c:3563\r\n#5  0x0000003cff04fd56 in H5AC_protect (f=<value optimized out>, dxpl_id=<value optimized out>, type=<value optimized out>, addr=<value optimized out>, udata=<value optimized out>, rw=<value optimized out>) at H5AC.c:1312\r\n#6  0x0000003cff117ab5 in H5O_protect (loc=0x7ffef0830c80, dxpl_id=167772168, prot=H5AC_READ) at H5O.c:1718\r\n#7  0x0000003cff139dcc in H5O_msg_exists (loc=0x7ffef0830c80, type_id=2, dxpl_id=167772168) at H5Omessage.c:885\r\n#8  0x0000003cff0d8eaa in H5G_obj_get_linfo (grp_oloc=0x7ffef0830c80, linfo=0x7ffef0830a20, dxpl_id=167772168) at H5Gobj.c:329\r\n#9  0x0000003cff0d93a7 in H5G_obj_lookup (grp_oloc=0x7ffef0830c80, name=0x7ffef0830d20 \"seq\", lnk=0x7ffef0830bd0, dxpl_id=167772168) at H5Gobj.c:1135\r\n#10 0x0000003cff0e0780 in H5G_traverse_real (_loc=<value optimized out>, name=0x35006bf \"seq\", target=0, nlinks=0x7ffef0831228, op=0x3cff10a430 <H5L_link_cb>, op_data=0x7ffef08312a0, lapl_id=167772167, dxpl_id=167772168)\r\n    at H5Gtraverse.c:642\r\n#11 0x0000003cff0e133b in H5G_traverse (loc=0x7ffef0831440, name=0x35006b0 \"/supercontig_1/seq\", target=0, op=0x3cff10a430 <H5L_link_cb>, op_data=0x7ffef08312a0, lapl_id=167772167, dxpl_id=167772168) at H5Gtraverse.c:904\r\n#12 0x0000003cff10991c in H5L_create_real (link_loc=0x7ffef0831440, link_name=0x35006b0 \"/supercontig_1/seq\", obj_path=0x0, obj_file=0x0, lnk=0x7ffef0831340, ocrt_info=0x7ffef08313d0, lcpl_id=167772173, lapl_id=167772167, \r\n    dxpl_id=167772168) at H5L.c:1883\r\n#13 0x0000003cff109aea in H5L_link_object (new_loc=<value optimized out>, new_name=<value optimized out>, ocrt_info=<value optimized out>, lcpl_id=<value optimized out>, lapl_id=<value optimized out>, dxpl_id=<value optimized out>)\r\n    at H5L.c:1639\r\n#14 0x0000003cff085a3b in H5D_create_named (loc=<value optimized out>, name=<value optimized out>, type_id=50350561, space=0x4a0c030, lcpl_id=167772173, dcpl_id=<value optimized out>, dapl_id=167772167, dxpl_id=167772168) at H5Dint.c:430\r\n#15 0x0000003cff06edbb in H5Dcreate2 (loc_id=<value optimized out>, name=0x35006b0 \"/supercontig_1/seq\", type_id=50350561, space_id=67108866, lcpl_id=167772173, dcpl_id=167772202, dapl_id=167772167) at H5D.c:169\r\n#16 0x00000000004078aa in do_copy_objects ()\r\n#17 0x00000000004082f0 in copy_objects ()\r\n#18 0x000000000040697d in h5repack ()\r\n#19 0x000000000040e425 in main ()\r\n```\r\n\r\nThe segfaulting line occurs in [`H5O_dec_rc`](http://trac.alcf.anl.gov/projects/libs/browser/HDF5/src/H5O.c#L3418) of `H5O.c`, and appears to be due to the deference of the `oh` pointer, which contains `0x0` (i.e. [possibly set to](http://softwareengineering.stackexchange.com/a/128447), but functionally equivalent to, `NULL`).\r\n\r\n~~I am currently attempting to determine if I can reconstruct the Genomedata run in question and if can find any pertinent log information.~~\r\n\r\nI was not able to find any clear sample that was impacted by this segmentation fault. All of the outputs appeared similar (yet only 1 of 32 had a core dump produced). I may be able to comment further after continuing with downstream analyses, but that does not appear likely to yield further insight into this error.", "markup": "markdown", "html": "<p>One Genomedata run, out of multiple similar parallel runs, segfaulted, producing a core dump. This has also happened twice on a previous occasion, but I mis-attributed them to system-specific aberrations.</p>\n<p>Inspection of the <code>core</code> file produced (and enclosed, gzipped), via <code>file</code> yields:</p>\n<div class=\"codehilite language-text\"><pre><span></span>core.19535: ELF 64-bit LSB core file x86-64, version 1 (SYSV), SVR4-style, from &#39;h5repack -f GZIP=1 /mnt/work1/users/hoffmangroup/cviner/temp/genomedata.MfLZzl/&#39;, real uid: 1060, effective uid: 1060, real gid: 1037, effective gid: 1037, execfn: &#39;/usr/bin/h5repack&#39;, platform: &#39;x86_64&#39;\n</pre></div>\n\n\n<p><code>/usr/bin/h5repack --version</code> yielded: <code>h5repack: (Version 1.8.7)</code>.</p>\n<p>Execution of a <code>gdb</code> backtrace on <code>h5repack</code> with this core file, yields the following stack trace:</p>\n<div class=\"codehilite language-text\"><pre><span></span>Core was generated by `h5repack -f GZIP=1 /mnt/work1/users/hoffmangroup/cviner/temp/genomedata.MfLZzl/&#39;.\nProgram terminated with signal 11, Segmentation fault.\n#0  H5O_dec_rc (oh=0x0) at H5O.c:3416\n3416    H5O.c: No such file or directory.\n    in H5O.c\nMissing separate debuginfos, use: debuginfo-install hdf5-1.8.7-1.el6.rf.x86_64\n(gdb) bt\n#0  H5O_dec_rc (oh=0x0) at H5O.c:3416\n#1  0x0000003cff127ff7 in H5O_chunk_proxy_dest (f=0x267a2a0, dxpl_id=167772168, addr=&lt;value optimized out&gt;, _udata=&lt;value optimized out&gt;) at H5Ocache.c:1443\n#2  H5O_cache_chk_load (f=0x267a2a0, dxpl_id=167772168, addr=&lt;value optimized out&gt;, _udata=&lt;value optimized out&gt;) at H5Ocache.c:758\n#3  0x0000003cff067ea3 in H5C_load_entry (f=0x267a2a0, primary_dxpl_id=167772168, secondary_dxpl_id=&lt;value optimized out&gt;, type=0x3cff491f60, addr=&lt;value optimized out&gt;, udata=&lt;value optimized out&gt;, flags=512) at H5C.c:7955\n#4  H5C_protect (f=0x267a2a0, primary_dxpl_id=167772168, secondary_dxpl_id=&lt;value optimized out&gt;, type=0x3cff491f60, addr=&lt;value optimized out&gt;, udata=&lt;value optimized out&gt;, flags=512) at H5C.c:3563\n#5  0x0000003cff04fd56 in H5AC_protect (f=&lt;value optimized out&gt;, dxpl_id=&lt;value optimized out&gt;, type=&lt;value optimized out&gt;, addr=&lt;value optimized out&gt;, udata=&lt;value optimized out&gt;, rw=&lt;value optimized out&gt;) at H5AC.c:1312\n#6  0x0000003cff117ab5 in H5O_protect (loc=0x7ffef0830c80, dxpl_id=167772168, prot=H5AC_READ) at H5O.c:1718\n#7  0x0000003cff139dcc in H5O_msg_exists (loc=0x7ffef0830c80, type_id=2, dxpl_id=167772168) at H5Omessage.c:885\n#8  0x0000003cff0d8eaa in H5G_obj_get_linfo (grp_oloc=0x7ffef0830c80, linfo=0x7ffef0830a20, dxpl_id=167772168) at H5Gobj.c:329\n#9  0x0000003cff0d93a7 in H5G_obj_lookup (grp_oloc=0x7ffef0830c80, name=0x7ffef0830d20 &quot;seq&quot;, lnk=0x7ffef0830bd0, dxpl_id=167772168) at H5Gobj.c:1135\n#10 0x0000003cff0e0780 in H5G_traverse_real (_loc=&lt;value optimized out&gt;, name=0x35006bf &quot;seq&quot;, target=0, nlinks=0x7ffef0831228, op=0x3cff10a430 &lt;H5L_link_cb&gt;, op_data=0x7ffef08312a0, lapl_id=167772167, dxpl_id=167772168)\n    at H5Gtraverse.c:642\n#11 0x0000003cff0e133b in H5G_traverse (loc=0x7ffef0831440, name=0x35006b0 &quot;/supercontig_1/seq&quot;, target=0, op=0x3cff10a430 &lt;H5L_link_cb&gt;, op_data=0x7ffef08312a0, lapl_id=167772167, dxpl_id=167772168) at H5Gtraverse.c:904\n#12 0x0000003cff10991c in H5L_create_real (link_loc=0x7ffef0831440, link_name=0x35006b0 &quot;/supercontig_1/seq&quot;, obj_path=0x0, obj_file=0x0, lnk=0x7ffef0831340, ocrt_info=0x7ffef08313d0, lcpl_id=167772173, lapl_id=167772167, \n    dxpl_id=167772168) at H5L.c:1883\n#13 0x0000003cff109aea in H5L_link_object (new_loc=&lt;value optimized out&gt;, new_name=&lt;value optimized out&gt;, ocrt_info=&lt;value optimized out&gt;, lcpl_id=&lt;value optimized out&gt;, lapl_id=&lt;value optimized out&gt;, dxpl_id=&lt;value optimized out&gt;)\n    at H5L.c:1639\n#14 0x0000003cff085a3b in H5D_create_named (loc=&lt;value optimized out&gt;, name=&lt;value optimized out&gt;, type_id=50350561, space=0x4a0c030, lcpl_id=167772173, dcpl_id=&lt;value optimized out&gt;, dapl_id=167772167, dxpl_id=167772168) at H5Dint.c:430\n#15 0x0000003cff06edbb in H5Dcreate2 (loc_id=&lt;value optimized out&gt;, name=0x35006b0 &quot;/supercontig_1/seq&quot;, type_id=50350561, space_id=67108866, lcpl_id=167772173, dcpl_id=167772202, dapl_id=167772167) at H5D.c:169\n#16 0x00000000004078aa in do_copy_objects ()\n#17 0x00000000004082f0 in copy_objects ()\n#18 0x000000000040697d in h5repack ()\n#19 0x000000000040e425 in main ()\n</pre></div>\n\n\n<p>The segfaulting line occurs in <a data-is-external-link=\"true\" href=\"http://trac.alcf.anl.gov/projects/libs/browser/HDF5/src/H5O.c#L3418\" rel=\"nofollow\"><code>H5O_dec_rc</code></a> of <code>H5O.c</code>, and appears to be due to the deference of the <code>oh</code> pointer, which contains <code>0x0</code> (i.e. <a data-is-external-link=\"true\" href=\"http://softwareengineering.stackexchange.com/a/128447\" rel=\"nofollow\">possibly set to</a>, but functionally equivalent to, <code>NULL</code>).</p>\n<p><del>I am currently attempting to determine if I can reconstruct the Genomedata run in question and if can find any pertinent log information.</del></p>\n<p>I was not able to find any clear sample that was impacted by this segmentation fault. All of the outputs appeared similar (yet only 1 of 32 had a core dump produced). I may be able to comment further after continuing with downstream analyses, but that does not appear likely to yield further insight into this error.</p>", "type": "rendered"}, "assignee": {"display_name": "Coby Viner", "uuid": "{5c0277b2-d18f-432a-9ff0-3377d3063bd6}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5c0277b2-d18f-432a-9ff0-3377d3063bd6%7D"}, "html": {"href": "https://bitbucket.org/%7B5c0277b2-d18f-432a-9ff0-3377d3063bd6%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/30ee4699432a3591c043fbe3d4bff771d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCV-5.png"}}, "nickname": "cviner2", "type": "user", "account_id": "557058:278c659b-177a-486c-bf20-6982986d7e43"}, "state": "wontfix", "version": null, "edited_on": null, "created_on": "2017-02-27T17:11:09.534141+00:00", "milestone": null, "updated_on": "2019-07-06T18:23:41.512710+00:00", "type": "issue", "id": 32}